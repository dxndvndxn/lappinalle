<template>
    <div class="catalog-items" v-if="total">
        <div class="item" v-for="(item, i) in catalogData" @mouseleave="hideElements(i)">
            <svg v-if="item.activeIconT" @click="item.activeTshirt = !item.activeTshirt" :class="item.activeTshirt ? 'fill-svg' : null" width="30" height="28" class="icon-cell t-shirt" viewBox="0 0 30 28" xmlns="http://www.w3.org/2000/svg">
                <path  d="M23.5405 27.6801H23.2594C18.037 27.6801 12.815 27.6801 7.59337 27.6801C7.21784 27.6801 6.87614 27.6066 6.69304 27.2521C6.60598 27.0701 6.5617 26.8707 6.56358 26.669C6.55659 21.2716 6.55659 15.8735 6.56358 10.4746V10.1247C6.46095 10.2157 6.39798 10.2647 6.34433 10.3218C5.86034 10.8443 5.37519 11.3656 4.8947 11.8904C4.77807 12.0175 4.68128 12.161 4.56465 12.2869C4.53615 12.3267 4.49859 12.359 4.45509 12.3814C4.41159 12.4037 4.36339 12.4153 4.3145 12.4153C4.2656 12.4153 4.2174 12.4037 4.1739 12.3814C4.1304 12.359 4.09284 12.3267 4.06434 12.2869C3.49055 11.6867 2.9187 11.0845 2.3488 10.4804C1.88697 9.99217 1.42709 9.50196 0.969145 9.00981C0.651928 8.66927 0.338209 8.32406 0 7.96019C0.289227 7.6803 0.553963 7.42606 0.816366 7.16948C1.24787 6.74614 1.68288 6.32746 2.09923 5.89595C2.64153 5.34199 3.17566 4.7787 3.70864 4.21541C4.18213 3.71509 4.65562 3.21361 5.11862 2.6993C5.39735 2.39374 5.64226 2.05553 5.93498 1.76631C6.15773 1.53306 6.42713 1.35346 6.67204 1.14587C7.27616 0.635056 8.02605 0.591905 8.75844 0.489276C9.3159 0.411138 9.87453 0.338831 10.4297 0.246698C10.7644 0.190719 11.0944 0.0997533 11.4268 0.0309452C11.9504 -0.0786811 12.3061 0.102086 12.5639 0.587241C12.7785 0.993092 12.9997 1.39544 13.2275 1.7943C13.3036 1.9193 13.3919 2.03649 13.491 2.14417C13.8176 2.51153 14.1663 2.8649 14.6001 3.09348C14.9197 3.26259 15.2894 3.2381 15.6497 3.15296C16.2643 3.00602 16.6189 2.53952 16.9419 2.06253C17.2288 1.63569 17.4504 1.16569 17.7081 0.720192C18.1746 -0.0821794 18.3542 -0.0646863 19.1846 0.0764284C20.3753 0.28052 21.5614 0.505603 22.751 0.719025C23.0371 0.754551 23.3027 0.886123 23.5043 1.09222C24.1971 1.82812 24.9038 2.55002 25.6036 3.28242C26.0304 3.73025 26.4444 4.18975 26.8666 4.64108C27.6725 5.4971 28.4842 6.34729 29.2842 7.2068C29.5175 7.45288 29.7076 7.73044 29.9291 7.98235C30.0224 8.08964 30.0248 8.15729 29.9291 8.25875C29.5404 8.65527 29.154 9.05607 28.7699 9.46114C27.9924 10.2798 27.2188 11.1001 26.4491 11.9219C26.2788 12.1027 26.1179 12.2916 25.9395 12.491L23.6128 9.95796L23.5557 9.98478L23.5405 27.6801ZM25.9418 10.5726C26.0397 10.4559 26.1132 10.3521 26.1984 10.2635C26.8526 9.5766 27.5069 8.89085 28.1681 8.21093C28.2731 8.10364 28.2626 8.04066 28.1681 7.94037C27.6701 7.41906 27.1792 6.89075 26.6858 6.36595C26.21 5.85747 25.7377 5.34432 25.2584 4.83934C24.6053 4.15009 23.9475 3.46785 23.2933 2.78093C23.2186 2.7028 23.1638 2.60366 23.0833 2.53252C22.8956 2.36342 22.7696 2.11851 22.4851 2.06603C21.9894 1.97273 21.4973 1.85727 21.0016 1.76864C20.3473 1.65201 19.6908 1.54939 19.0353 1.44093C18.9653 1.41777 18.8891 1.42212 18.8222 1.45309C18.7553 1.48406 18.7026 1.53934 18.675 1.6077C18.3612 2.2258 18.0627 2.8579 17.5717 3.36405C17.2883 3.65678 17.0259 3.99965 16.6854 4.20258C16.3794 4.39521 16.0365 4.52153 15.6787 4.57336C15.321 4.62519 14.9563 4.60137 14.6083 4.50346C14.2563 4.39372 13.9226 4.23217 13.6182 4.02414C13.171 3.71738 12.7741 3.34326 12.4414 2.91505C12.1125 2.52086 11.8723 2.05087 11.6122 1.60303C11.5845 1.5391 11.5348 1.48718 11.4721 1.45661C11.4095 1.42604 11.338 1.41883 11.2705 1.43626C10.846 1.50857 10.4227 1.58204 9.99815 1.65318C9.47101 1.74065 8.94271 1.82928 8.41324 1.90859C7.90826 1.98556 7.42077 2.12901 7.06157 2.50104C6.52976 3.0515 6.04344 3.64628 5.52097 4.20608C4.73726 5.0481 3.94188 5.88079 3.14418 6.71115C2.78148 7.09018 2.41295 7.46571 2.02809 7.82374C1.85315 7.98702 1.88814 8.09314 2.02809 8.23892C2.43277 8.65411 2.82929 9.07628 3.22931 9.49496C3.28762 9.55677 3.33894 9.62441 3.39725 9.68506C3.69231 9.99528 3.98853 10.3043 4.29409 10.6239L7.67967 6.93041C7.70008 6.99089 7.71568 7.0529 7.72632 7.11584C7.76248 7.71178 7.82429 8.30773 7.82545 8.90368C7.83245 14.6167 7.83245 20.3312 7.82545 26.0474V26.3413H22.2576V26.1162C22.2576 20.159 22.2576 14.2015 22.2576 8.24359C22.2576 8.06282 22.2961 7.95086 22.4757 7.88672C22.674 7.81675 22.8606 7.71295 23.0588 7.65347C23.0992 7.64403 23.1411 7.64385 23.1815 7.65294C23.2219 7.66203 23.2597 7.68015 23.2921 7.70595C23.4764 7.88555 23.642 8.08498 23.8169 8.27391C24.2134 8.69725 24.6123 9.11943 25.0076 9.54394C25.0496 9.58826 25.0776 9.64541 25.1243 9.69089C25.3773 9.97079 25.6491 10.2553 25.9395 10.5726H25.9418Z"/>
                <path d="M11.9248 9.01564H12.1837C14.0741 9.01564 15.9646 9.01564 17.8551 9.01564C18.0673 9.01564 18.1536 8.96549 18.1327 8.74274C18.1128 8.53981 18.1233 8.33339 18.1222 8.12813C18.1222 7.83774 18.2854 7.73044 18.5303 7.88205C19.0843 8.22493 19.6301 8.5818 20.1806 8.93167C20.2867 8.99814 20.3998 9.05412 20.5024 9.12643C20.6995 9.26638 20.7042 9.42965 20.5024 9.55677C20.1153 9.80518 19.7211 10.0396 19.3304 10.2833C19.0738 10.4431 18.8242 10.6145 18.5653 10.7697C18.2843 10.9376 18.1303 10.8501 18.1257 10.5306C18.1257 10.3265 18.1152 10.1201 18.1257 9.91597C18.1362 9.74687 18.0732 9.70255 17.9099 9.70372C16.8603 9.70955 15.799 9.70372 14.7436 9.70372C13.8771 9.70372 13.0105 9.70955 12.144 9.70372C11.9539 9.70372 11.87 9.74454 11.8875 9.94979C11.8974 10.1468 11.8974 10.3441 11.8875 10.5411C11.8875 10.8431 11.7265 10.9364 11.4606 10.7743C10.9941 10.5003 10.5416 10.2169 10.0856 9.93463C9.88736 9.81218 9.69143 9.68622 9.5025 9.55444C9.31357 9.42265 9.32989 9.24072 9.52232 9.11827C9.96433 8.83953 10.4122 8.5713 10.8553 8.29373C11.0524 8.17711 11.2367 8.029 11.4385 7.91121C11.7487 7.72694 11.891 7.80975 11.8921 8.16545V8.92117C11.9004 8.9535 11.9113 8.98509 11.9248 9.01564Z" fill="#848CCF"/>
            </svg>
            <div class="item-sizes" v-if="item.activeTshirt">
                <span v-for="(sizeInner, size, i) in sizesForProduct" v-if="sizeInner.ids.find(el => el === item.product_id)">
                    {{size}}
                </span>
            </div>
            <router-link :to="{path: `item-${item.product_id}`}" :append="true">
                <img v-bind:src="item.product_img.split(',')[0]" alt="" @mouseover="showElements(i)">
            </router-link>
            <svg v-if="item.activeIconB || returnBook.find(el => el === item.product_id)" @click="addBookmark(i, item.product_id)" :class="item.activeBook || returnBook.find(el => el === item.product_id) ? 'fill-svg' : null" width="30" height="28" class="icon-cell book" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 361.33 348.7"><title>icon_izb</title><path d="M139,187.84c.31-1.27.57-2.56.95-3.8,3.15-10.21,10.48-15.77,20.64-17.29,30.69-4.59,61.42-8.88,92.15-13.22a4.56,4.56,0,0,0,3.84-2.8q20.55-41.22,41.2-82.39c4.8-9.58,12.7-14.39,23.36-13.83C331,55,337.71,60.6,342,69.18c7.6,15,15.11,30.14,22.66,45.22q9.12,18.22,18.21,36.47a4.41,4.41,0,0,0,3.75,2.64c15.4,2.14,30.78,4.4,46.16,6.6s30.65,4.46,46,6.54c11.84,1.61,20.49,10.23,21.44,22.11.61,7.72-2.59,14.1-8.07,19.39q-17.49,16.86-35,33.68c-8.22,7.9-16.41,15.84-24.68,23.7a11.12,11.12,0,0,1-14.66,1.1,10.81,10.81,0,0,1-1.08-16.8c8.81-8.56,17.71-17,26.57-25.55q16.64-16,33.22-32a3.46,3.46,0,0,0,1.1-2.48c-.08-.52-1.4-1.09-2.22-1.21q-40.37-5.88-80.74-11.64c-4.3-.62-8.61-1.17-12.9-1.85-8.67-1.37-14.81-6.11-18.72-14q-15.4-30.93-30.92-61.79c-3.47-6.92-6.91-13.86-10.45-20.74a3.73,3.73,0,0,0-2.12-1.94c-.54-.09-1.53,1.09-1.93,1.89-13.43,26.77-27,53.47-40.11,80.42-5,10.28-12.6,15.42-23.8,16.82-20.05,2.51-40,5.65-60,8.52-9.91,1.42-19.82,2.8-29.72,4.27-.82.12-2,.63-2.22,1.23s.41,1.75,1,2.32c21.63,20.87,43.12,41.88,65,62.44,8.5,8,11.23,16.81,9.09,28.18-5,26.6-9.39,53.3-14,80-.45,2.61-1,5.2-1.35,7.82-.11.83,0,2.1.56,2.49s1.79.12,2.52-.26q36.57-18.89,73.08-37.85c5.14-2.66,10.4-1.94,14,1.9,5.12,5.38,3.67,13.79-3.13,17.4-8.27,4.41-16.62,8.67-24.94,13q-24.37,12.64-48.77,25.29c-11.62,6-25.2,2.73-32.13-7.7-3.93-5.91-4.43-12.33-3.22-19.19,5.31-29.93,10.47-59.89,15.71-89.83a3.81,3.81,0,0,0-1.48-3.63Q188.7,248.08,163.64,224q-8.44-8.13-16.89-16.25a23.68,23.68,0,0,1-7.44-14.08,4.2,4.2,0,0,0-.31-.88Z" transform="translate(-139 -54.46)"/><path d="M383.14,346.75H380.6c-13.66,0-27.33,0-41,0a20.3,20.3,0,0,1-5.05-.53,10.74,10.74,0,0,1,.25-21.09,19.27,19.27,0,0,1,4.49-.44c13.73,0,27.46,0,41.19,0H383c0-.81.11-1.53.11-2.25,0-13.61,0-27.21,0-40.82a19.65,19.65,0,0,1,.52-4.85,11.12,11.12,0,0,1,10.92-8.47,11.25,11.25,0,0,1,10.55,9,18.88,18.88,0,0,1,.4,4.12q0,20.49,0,41v2.3h2.34c13.85,0,27.71,0,41.57,0a18.73,18.73,0,0,1,4.67.5,11,11,0,0,1,8.53,11.58c-.39,4.92-5,9.31-10.4,9.87-1.13.11-2.27.12-3.4.12H405.55v2.38c0,13.67,0,27.34,0,41a17.21,17.21,0,0,1-.7,5,11,11,0,0,1-11.63,7.95,11.64,11.64,0,0,1-10-10.54c-.09-1-.08-2-.08-3q0-20.11,0-40.25Z" transform="translate(-139 -54.46)"/></svg>
            <div class="item-title">
                {{item.product_title}}
            </div>
            <div class="item-price" v-if="item.product_old_price !== null">
                <span class="through-line">{{item.product_old_price * EU}} &#8381;</span> <span class="sale-price">{{item.product_price * EU}} &#8381;</span>
            </div>
            <div v-else class="item-price">
                {{item.product_price * EU}} &#8381;
            </div>
        </div>
    </div>
    <p v-else class="catalog-error">
       По вашему запросу ничего не найдено.
    </p>
</template>

<script>
    export default {
        name: "CatalogCell",
        props: ['catalogData','total'],
        data: () => ({
            book: null
        }),
        watch:{
            catalogData(val){
                this.CatalogData = val;
            }
        },
        methods:{
            hideElements(i){
              this.catalogData[i].activeIconT = false
              this.catalogData[i].activeIconB = false
              this.catalogData[i].activeTshirt = false;
          },
            showElements(i){
                this.catalogData[i].activeIconT = true
                this.catalogData[i].activeIconB = true
            },
            addBookmark(i, id){
                this.catalogData[i].activeBook = !this.catalogData[i].activeBook;
                let idThere = this.returnBook.find(el => el === id);
                if (!idThere) this.$store.dispatch('AddBookmark', id);
            }
        },
        computed: {
            EU(){
                return this.$store.getters.EU;
            },
            sizesForProduct(){
                return this.$store.getters.filterSizes;
            },
            returnBook(){
                return this.$store.getters.bookmarks;
            }
        }
    }
</script>

<style scoped>

</style>
